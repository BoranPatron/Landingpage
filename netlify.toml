[build]
  command = "npm run build"
  publish = "Landingpage"
  functions = "Landingpage/netlify/functions"
  environment = { DEPLOYMENT_MODE = "production" }

# Netlify Environment Variables
# Setze diese im Netlify Dashboard:
# - API_BASE_URL (z.B. https://buildwise-api.onrender.com)
# - FRONTEND_URL (z.B. https://www.buildwise.ch)
# - BREVO_API_KEY (dein API Key)

# SPA Routing: Alle nicht-existierenden Pfade zu index.html
# Beachte: Diese Regel gilt nur für nicht-existierende Dateien
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
  force = false

# API Redirect für Netlify Functions
[[redirects]]
  from = "/api/beta-subscribe"
  to = "/.netlify/functions/brevo-beta-subscribe"
  status = 200

# Content Security Policy Headers für Google Ads & Analytics
[[headers]]
  for = "/*"
  [headers.values]
    Content-Security-Policy = """
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' 
        https://www.googletagmanager.com 
        https://www.google-analytics.com 
        https://www.google.com 
        https://cdn.tailwindcss.com 
        https://unpkg.com;
      connect-src 'self' 
        https://www.googletagmanager.com 
        https://www.google-analytics.com 
        https://www.google.com 
        https://*.google-analytics.com 
        https://*.analytics.google.com;
      img-src 'self' data: blob: 
        https://www.googletagmanager.com 
        https://www.google-analytics.com 
        https://www.google.com 
        https://*.google-analytics.com 
        https://*.googletagmanager.com;
      style-src 'self' 'unsafe-inline' 
        https://fonts.googleapis.com 
        https://unpkg.com;
      font-src 'self' 
        https://fonts.gstatic.com 
        https://fonts.googleapis.com;
      frame-src 'self' 
        https://www.googletagmanager.com;
    """

